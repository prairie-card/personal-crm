# Personal CRM v1 - プロダクト仕様書（非技術者向け）

> **このドキュメントの目的**: エンジニアではないメンバーとも共有・議論できるよう、技術的詳細を排除したプロダクト仕様書です。
> 機能を画面ごとに階層化し、実装の優先順位を判断しやすい粒度で記述しています。

## 画面構成

### 3タブ構成

- **Home**: 今日のイベント、新着コンタクト、自分のアクション履歴
- **Contacts**: 全コンタクトのリスト表示
- **Settings**: 各種設定

---

## 機能仕様

### Home画面

- **今日のイベントセクション**
  - 今日から1週間以内に誕生日を迎えるコンタクトを表示
    - アバター/写真
    - 名前 + "さんの誕生日"
    - 年齢（例: 40歳のお誕生日おめでとうございます！）
    - 会社名・肩書
  - すでに送信済みのコンタクトは表示しない
  - カードをタップ → コンタクト詳細画面へ
  - 「お祝いを送る」ボタン
    - タップ → 誕生日メッセージモーダル表示
    - トーン選択（カジュアル / ニュートラル / フォーマル / 自分で書く）
    - 1.5秒のローディング後、文面生成（モック）
    - 生成された文面は自由に編集可能
    - 送信方法を選択
    - コピーボタン → クリップボードにコピー
    - メールで送る（メールアドレスが登録されている場合のみ）
    - Messengerで送る（Facebookアカウントが登録されている場合のみ）
    - **未実装**: 送信方法に応じたボタン表示の動的変更（現状は全ボタン表示）
    - 送信済みにする → 今日のイベントから消える
- **新着コンタクトセクション**
  - 新着コンタクトをカード形式で表示
    - アバター/写真
    - 名前
    - 肩書
    - 会社名
    - NEWバッジ（未開封タグがある場合）
  - カードをタップ → コンタクト詳細画面へ（未開封タグを自動削除）
  - アクションボタン
    - **メモボタン**
      - タップ → メモ追加モーダル表示
      - メモ入力 → 追加ボタンでActivityに記録
      - メモ追加後もステータスは変わらず新着コンタクトに残る
      - フラッシュメッセージ表示「メモを追加しました」
    - **お礼の連絡ボタン**
      - タップ → フォローアップメッセージモーダル表示
      - トーン選択（カジュアル / ニュートラル / フォーマル / 自分で書く）
      - 1.5秒のローディング後、文面生成（モック）
      - 生成された文面は自由に編集可能
      - 送信方法を選択
      - コピーボタン → クリップボードにコピー
      - メールで送る（メールアドレスが登録されている場合のみ）
      - Messengerで送る（Facebookアカウントが登録されている場合のみ）
      - **未実装**: 送信方法に応じたボタン表示の動的変更（現状は全ボタン表示）
      - 送信済みにする → 新着コンタクトから消える
    - **後でボタン**
      - タップ → 新着コンタクトから消える（アーカイブ扱い）
  - **要議論**: 新着コンタクトの定義（現状: 明示的にマークされたもののみ。1週間以内の出会いや、1週間以内にアクションがないコンタクトの判定を追加するべき？）
- **Activityセクション（自分のアクション履歴）**
  - 自分が行ったアクションを時系列表示
    - ユーザーアイコン（左側）
    - アクションタイプアイコン（右下に小さく表示）
    - アクション内容（例: 「田中太郎さんにメモを追加しました: XXX」）
    - 相対時間（例: 5分前、2時間前、3日前）
  - タップ → Activity詳細モーダル表示
    - コンタクトアバター/写真
    - コンタクト名
    - アクティビティの詳細情報
    - タイムスタンプ
    - 「コンタクトを見る」ボタン → コンタクト詳細画面へ
  - 表示件数: 設定で指定された件数（デフォルト10件）
  - **要議論**: デフォルト表示件数（現状10件、適切？）

---

### Contacts画面

- **コンタクト一覧**
  - 新着コンタクトを最上位に表示
    - 新着バッジ付き
  - 同じステータス内では作成日時の降順
  - 表示内容
    - アバター/写真
    - 名前
    - 肩書
    - 会社名
    - ソース（流入経路）
  - タップ → コンタクト詳細画面へ

---

### コンタクト詳細画面

- **ヘッダー**
  - 戻るボタン（←）
  - 編集ボタン → 編集モーダル表示
- **プロフィールセクション**
  - アバター/写真
  - 名前
  - よみがな
  - 肩書
  - 会社名
  - タグライン（あれば）
- **連絡先情報**
  - よみがな
  - メールアドレス（タップでメーラー起動）
  - 電話番号（タップで電話アプリ起動）
- **出会った情報**
  - 出会った場所
  - 詳細
- **タグ**
  - コンタクトに紐づくタグを青いバッジで表示
- **組織情報**
  - 会社・組織名
  - 部署名
  - 役職・肩書
  - 会社住所
  - 会社電話
  - 会社URL
- **SNSアカウント**
  - LinkedIn, Twitter, Facebook, Instagram等のリンク
  - 4カラムのグリッド表示
  - **未実装**: SNSアイコンの表示（現状はプラットフォーム名のみ）
  - **要議論**: アイコン画像を表示するべき？
- **関連記事・URL**
  - サムネイル画像（未実装、Globe アイコン表示）
  - タイトル（モック）
  - メタディスクリプション（モック）
  - URL
  - **未実装**: OGP画像の取得
  - **要議論**: サムネイル画像を取得して表示するべき？
- **Timeline（その人の人生の出来事）**
  - コンタクト本人に関する出来事や情報を表示（読み取り専用）
  - 日付（MM.DD形式）
  - エントリータイプ（linkedin, birthday, promotion, marriage, childbirth, job-change, new-product）
  - 内容
  - 誕生日があれば自動的にTimelineに追加
  - LinkedInの投稿や昇進などのライフイベント（モック表示）
  - 背景色: グレー
  - **要議論**: Timelineの色分けは必要？（現状グレー統一、誕生日はピンク・その他はブルーなど）
- **Activity（自分のアクション）**
  - このコンタクトに対して行ったアクションを表示
  - 日付（MM.DD形式）
  - エントリータイプ（note, follow-up-sent, meeting, contact_created）
  - 内容
  - 「メモを追加」ボタン
    - タップ → テキストエリア表示
    - 入力後「追加」ボタンでActivityに追加
  - メモをタップ → 全文表示モーダル
  - V1で非表示: Reminder関連のアクティビティは除外
- **アクションセクション**
  - **「フォローアップ文章を作成」ボタン**
    - タップ → フォローアップメッセージモーダル表示
    - トーン選択、メッセージ生成、送信方法選択（新着コンタクトのお礼の連絡と同じ）
- **「この人物を深く掘る」ボタン**
  - タップ → ディープリサーチ開始（モックで3秒後に完了）
  - 実行中: ローディング表示
  - 完了: 通知に結果を表示
  - SNSプロフィール情報の自動収集（モック）
  - フラッシュメッセージ表示
- **「このコンタクトを削除」ボタン**
  - タップ → 削除確認モーダル表示
  - 確認後、コンタクトを削除
  - Activityに削除履歴を記録
  - 削除後はHome画面に遷移
  - **要議論**: 削除前の確認メッセージの文言は適切？
- **編集モーダル**
  - 自動保存（入力内容は即座に保存）
  - 編集可能項目
  - 基本情報（名前、よみがな、肩書、会社名など）
  - 連絡先情報
  - 出会った情報
  - 組織情報
  - SNSアカウント
  - タグ
  - メモ
  - 「AIで深く掘る」ボタン
    - ディープリサーチを実行
    - 通知追加、ステータス更新、フラッシュメッセージ表示
    - 3秒後に完了ステータスに更新
- 「閉じる」ボタン
  - 編集元がコンタクト詳細画面の場合 → 詳細画面に戻る
  - 直接開いた場合 → Homeに戻る

---

### Settings画面

- **外部連携（V1では仮）**
  - Prairie Card
    - 接続済み
    - 「設定を確認」ボタン
  - Slack
    - 未接続
    - 「連携」ボタン
  - Facebook
    - 未接続
    - 「連携」ボタン
- **通知設定**
  - 誕生日通知: ON/OFFトグル
  - V1で非表示: フォローアップリマインド、転職通知
- **Timeline設定**
  - 通知してほしい内容を選択
  - 誕生日
  - 昇進
  - 結婚
  - 出産
  - 転職
  - 新商品発表
  - その他（カスタム追加可能）
  - Activityの表示件数: スライダーで調整（5件〜30件）
  - **要議論**: 表示件数の範囲（現状5〜30件、適切？）
- **その他メニュー**
  - AI設定（未実装）
  - プライバシー（未実装）
  - About（未実装）

---

### ディープリサーチ機能

- 紙名刺読み取り、コンタクト作成後、その情報をソースとして人物検索を開始
- 詳細は別資料

### 共通機能

- **3タブナビゲーション**
  - Home / Contacts / Settings
  - タップで切り替え
  - 現在のタブをハイライト表示
- **新規コンタクト追加ボタン**
  - フローティングボタン（右下）
  - タップ → コンタクト追加モーダル表示
  - **未実装**: 実際のコンタクト追加機能（現状はサンプルデータ追加のみ）
- **通知ボタン**
  - ヘッダー右上
  - タップ → 通知一覧モーダル表示
  - ディープリサーチ完了通知
  - その他の通知（未実装）
  - 通知タップ → 該当コンタクトの詳細画面へ
- **フラッシュメッセージ**
  - アクション完了時に画面上部に表示
  - メッセージテキスト
  - アクションボタン（オプション）
  - 例: 「メモを見る」→ コンタクト詳細へ
  - デフォルト5秒間表示
  - 閉じるボタンで手動で閉じる

---

## ディスカッション項目（未決定事項）

### データ・表示件数関連

1. **Activityのデフォルト表示件数**
    - 現状: 10件
    - 検討: もっと多い方が良い？少ない方が良い？
2. **Activity表示件数の調整範囲**
    - 現状: 5〜30件
    - 検討: この範囲は適切？
3. **新着コンタクトの定義**
    - 現状: 新着状態として明示的にマークされたコンタクト
    - 検討: 「1週間以内に追加されたコンタクト」や「1週間以内にアクションがないコンタクト」など、時間ベースの判定を追加するべき？

### UI/UX関連

1. **Timelineの色分け**
    - 現状: 全てグレー統一（ハリボテルールに準拠）
    - 検討: 誕生日はピンク、その他はブルーなど色分けするべき？
2. **SNSアイコンの表示**
    - 現状: プラットフォーム名のみテキスト表示
    - 検討: アイコン画像を表示するべき？
3. **関連記事のサムネイル**
    - 現状: Globeアイコンのみ
    - 検討: OGP画像を取得して表示するべき？

### 機能の振る舞い関連

1. **フォローアップモーダルのボタン表示**
    - 現状: メール/Messenger両方のボタンを常に表示
    - 検討: 登録されている連絡先に応じて動的に表示・非表示を切り替えるべき？
2. **メモの保存先**
    - 現状: アクティビティに履歴として記録のみ
    - 検討: コンタクトデータに直接紐付けて保存するべき？
3. **削除時の確認**
    - 現状: 確認モーダル表示
    - 検討: 削除前の確認メッセージの文言は適切？
